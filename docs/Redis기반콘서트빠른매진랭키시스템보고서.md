# 🚀 Redis 기반 콘서트 빠른 매진 랭킹 시스템 구현

## 📌 개요

콘서트 스케줄이 빠르게 매진되는 순서대로 사용자에게 랭킹을 제공하기 위해,  
**Redis Sorted Set**을 활용한 실시간 랭킹 시스템을 설계 및 구현했습니다.

---

## ✅ 주요 기능

### 1. 콘서트 매진 시점 기록 (ZSet 기반 랭킹)
- 결제 시 예약 수를 Redis에서 `INCR`
- **50번째 예약**일 때만 랭킹 저장 트리거
- `score = 스케줄 오픈 시점 ~ 매진 시점까지 걸린 시간(ms)`
- `ZSet Key`: `concert:ranking:{yyyyMMdd}`

### 2. 스케줄 예약 수 TTL 관리
- Key: `concert:{concertId}:schedule:{scheduleId}:count`
- **해당 공연 날짜 자정까지 TTL 설정**
- 일 단위로 자동 만료 처리

### 3. 랭킹 TTL 관리
- 랭킹 키는 **2일 뒤 자정까지 유지**
- 랭킹이 없을 경우, **어제 랭킹으로 fallback**

---

## 🧪 테스트 항목

- 예약 수 증가 및 TTL 설정 검증
- 50번째 예약 시 랭킹 저장 여부 테스트
- TTL 초 단위 ±1 오차 허용으로 정확도 테스트

---

## 🧠 설계 포인트

- 랭킹 집계에 DB 부하를 유발하지 않도록 Redis 단독 처리
- TTL을 이용한 자동 만료로 데이터 클린업 비용 절감
- 키 설계 기준은 날짜 기반으로 일간 랭킹 구성
- 랭킹 조회는 정렬된 ZSet의 range 연산으로 빠르게 처리

---

## ✨ 향후 확장 아이디어

- Kafka 등 이벤트 기반으로 랭킹 저장 비동기화
- 매진 속도 외에 예매 수 기반 랭킹 제공 가능
- 주간/월간 랭킹을 위한 key 설계 확장 가능
